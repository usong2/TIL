# 01. 운영체제 이해 및 관리

## Point 1. CPU(Central Processing Unit, 중앙처리장치)의 구조적 이해

### 1. CPU의 구조 이해

#### (1) CPU 개념

입력장치로부터 자료를 받아서 연산하고 그 결과를 출력장치로 보내는 일련의 과정을 제어하며 해당 장치로 컴퓨터의 두뇌에 해당한다.

> **컴퓨터 시스템 구조**
>
> Main Memory ↔ ALU(CA)   ↔ 입출력장치(I/O)
>
> ​                                  ↑
> ​                                  ↓ Register
>
> 메모리(M) ↔ Control Unit(CC)

##### CPU의 구성요소

| 구성요소               | 상세 기능                                                    |
| ---------------------- | ------------------------------------------------------------ |
| ALU(연산장치)          | - 각종 산술연산들과 논리연산들을 수행하는 회로<br />- 산술연산: +, -, x, /<br />- 논리연산: AND, OR, NOT, XOR |
| Register(레지스터)     | - CPU 내부의 소규모 데이터나 중간 결과를 일시적으로 기억해 두는 고속의 전용 영역<br />- 컴퓨터 기억장치 중 Access 속도가 가장 빠름 |
| Control Unit(제어장치) | 프로그램 코드(명령어)를 해석하고, 그것을 실행하기 위한 제어 신호들(Control Signals)을 발생시킴 |
| 내부 CPU 버스          | ALU와 레지스터 간의 데이터 이동을 위한 경로                  |

##### 레지스터(Register) 종류

| 종류                         | 주요 기능                                              |
| ---------------------------- | ------------------------------------------------------ |
| PC(Program Counter)          | 다음에 수행할 명령어가 저장된 주기억장치의 번지를 지정 |
| MAR(Memory Address Register) | 주기억장치에 접근하기 위한 주기억장치의 번지를 기억    |
| MBR(Memory Buffer Register)  | 주기억장치에 입/출력할 자료를 기억하는 레지스터        |
| IR(instruction Register)     | 주기억장치에서 인출한 명령코드를 기억하는 레지스터     |

### 2. 버스 시스템(Bus System)

#### (1) 버스(Bus)의 정의

버스(Bus)는 시스템에 많은 장치를 공유하여 데이터, 주소, 제어 정보를 전달하는 전송 라인이다. 한정된 자원이므로 버스를 획득하기 위한 경합이 많이 발생하는 장치이기 때문에 사용하는 방식에 따라 입출력 성능에 영향을 준다.

> **주기억장치**(명령어와 자료 저장) --------명령어와 자료 전송(Load)--------->
>
> ​                                                       <-----------처리 결과 전송(Save)------------ **중앙처리장치**(명령어 처리)

#### (2) 버스(Bus) 종류

| 종류                   | 내용                                                         |
| ---------------------- | ------------------------------------------------------------ |
| 데이터 버스(Data Bus)  | 시스템 컴포넌트 간 처리 데이터를 전송하기 위한 용도          |
| 주소 버스(Address Bus) | - 기억장소의 위치 또는 장치 식별을 지정하기 위한 라인<br />- 라인의 비트 수에 따라 접속될 수 있는 장치의 용량이 결정됨 |
| 제어 버스(Control Bus) | CPU와 기억장치 또는 I/O 장치 사이의 제어 신호를 전송하는 라인 |

### 3. CPU의 명령 실행 주기(Instruction Cycle)

CPU의 명령어 처리(Instruction Cycle)는 하나의 명령어 실행이 끝난 후, 다음 명령어의 수행이 시작되어 끝날 때까지 걸리는 시간을 말한다. 즉, 한 명령을 수행하는 데 명령 인출, 해독, 피연산자 인출, 실행, 결과 저장 등의 여러 단계를 거쳐야 하는데, 이러한 단계를 거쳐 한 명령이 실행되고 다시 다음 명령의 인출이 반복되는 주기를 말한다.

**인스트럭션 사이클**은 **패치(fetch)**, **간접(indirect)**, **실행(execution) 및 인터럽트(interrupt)**로 구성된다. 인스트럭션 사이클의 실행 주기는 2단계, 4단계, 5단계 사이클로 구분한다.

#### (1) 인스트럭션 실행(Instruction Cycle)

| 단계                    | 동작 설명                                                    |
| ----------------------- | ------------------------------------------------------------ |
| 인출(Instruction Fetch) | 인출 단계는 메모리(Memory)에서 데이터를 로드(Load)하여 CPU에 있는 레지스터(Register)에 적재하는 과정 |
| 간접(Indirect)          | - 메모리를 참조할 때 간접주소 방식을 사용하는 경우에 실행<br />- 간접주소란 CPU가 메모리를 참조했을 때 데이터가 존재하는 것이 아니라 메모리에 주소가 존재하여 메모리 내에서 한 번 더 조회해서 데이터를 얻는 것 |
| 실행(Execution)         | 명령과 데이터로 CPU가 산술 및 논리연산을 수행하는 것         |
| 인터럽트(Interrupt)     | - 컴퓨터 작동 중 예기치 않은 문제가 발생한 경우라도 업무 처리가 계속될 수 있도록 하는 컴퓨터 운영체제의 한 기능. 크게 하드웨어 인터럽트와 소프트웨어 인터럽트로 나눔<br />- SVC 하드웨어 인터럽트: 기계착오 인터럽트, 외부 인터럽트, 입출력 인터럽트, 프로그램 검사 인터럽트<br />- 소프트웨어 인터럽트: CPU 내부에서 자신이 실행한 명령이나 CPU의 명령 실행에 관련된 모듈이 변화하는 경우 발생 |

<br />

## Point 2. 메모리 시스템(Memory System)

### 1. 기억장치 계층구조(Memory Hierarchy)

크기, 속도, 가격당 성능에 따라 분류된 기억장치를 계층적으로 구성함으로써 평균 기억장치 액세스 속도는 높이고 가격 대비 성능비도 적절히 유지하기 위한 설계 아키텍처라고 보면 된다.

#### (1) 메모리 계층구조의 이유

- 액세스 속도가 높아질수록 비트당 가격도 높아진다.
- 용량이 커질수록 비트당 가격은 낮아진다.
- 용량이 커질수록 액세스 속도는 낮아진다.

#### (2) 기억장치 계층구조

+ 레지스터
+ 캐시
+ 주기억장치
  + 프로그램과 데이터를 직접 읽을 수 있다.
+ 보조기억장치
  + 실행되기 위해서는 프로그램이나 데이터가 주기억장치에 옮겨져야 한다.

| 기억장치                                             | 기억장치 용량              | 비트당 기억 장치 비용      | 기억장치 속도              |
| ---------------------------------------------------- | -------------------------- | -------------------------- | -------------------------- |
| 레지스터<br />캐시<br />주기억장치<br />보조기억장치 | 감소<br /><br /><br />증가 | 증가<br /><br /><br />감소 | 증가<br /><br /><br />감소 |

고속의 CPU의 저속의 보조기억장치 사이에 캐시와 주기억장치를 배치하여 성능 차이를 극복하고, 빠르지만 고가인 SDRAM의 사용량을 줄여 가격적인 경쟁력을 확보할 수 있다.

### 2. 캐시 메모리(Cache Memory)

캐시 메모리는 **CPU와 주기억장치(Memory)의 속도 차이를 극복**하기 위해서 CPU와 주기억장치 사이에 존재하는 고속의 버퍼 메모리이다. 이러한 고속의 메모리를 사용하여 CPU가 작업을 빠르게 처리할 수 있다.

#### (1) 캐시 메모리(Cache Memory) 정의

중앙처리장치가 읽어 들인 데이터(명령, 프로그램)들로 채워지는 버퍼 형태의 고속 기억장치이다.

#### (2) 캐시 메모 사상(Mapping) 방식

##### 1) 직접사상(Direct Mapping)

- Main Memory를 여러 구역으로 분할하여 Cache 슬롯과 매핑한다.
  + 장점: 매핑 절차가 단순하고 신속하게 처리
  + 단점: 높은 캐시 미스율(같은 블록에 사상되는 데이터 캐시 적재 시 교체 발생)
  + 태그의 크기: 메모리를 2m 개의 구역으로 나눈 경우 m개의 태그 필요
  + 적재될 Cache의 주소(위치) 결정 방법
    + 방법 1: (메모리 블록 주소) modulo(캐시 전체 블록 수)
    + 방법 2: 캐시의 블록 수가 2N개일 경우 메모리 주소의 하위 N 비트
  + Index(색인): Cache의 순서 번호(순차적인 주소이기 때문에 별도 공간을 차지하지는 않음)
  + Valid bit(유효): 저장 데이터의 유효성 비트
  + Tag(태그): 맵핑된 메모리 주소의 Cache 식별을 위한 Index bit로 사용되는 하위 비트를 제외한 상위 비트

##### 2) 연관사상(Associate Mapping)

+ Main Memory의 각 블록이 Cache의 어느 슬롯이든 적재 가능하다.
  + 장점: 지역성 높은 접근 시 캐시 적중률 높음
  + 단점: 구현 하드웨어가 복잡하여 구현 비용 상승

##### 3) 집합 연관사상(Set Associate Mapping)

+ 직접사상/연관사상 절충 방식으로 캐시와 메모리가 M 대 1로 대응한다.
  + 장점: 직접사상과 연관사상의 장점 수용
  + 단점: 캐시 Fin/Fout 발생 증가. 구현 비용이 많이 듦

### 3. 캐시 메모리 관리 방식

CPU는 캐시 메모리에 접근하여 연산에 필요한 명령과 데이터를 읽어 들인다. 만약, CPU가 캐시 메모리에 접근할 때 원하는 데이터가 없다면, 캐시 메모리는 주기억장치에 접근하여 데이터를 캐시 메모리에 올려야 한다. 즉, 캐시 메모리 관리라는 것은 CPU가 원하는 데이터가 캐시 메모리에 있을 수 있도록 하는 것을 의미한다.

#### (1) 캐시 메모리 인출 방식

- Demand Fetch : 필요 시 캐시를 인출하는 방식
- Pre-Fetch : 예상되는 블록을 미리 패치 해 두는 방식



