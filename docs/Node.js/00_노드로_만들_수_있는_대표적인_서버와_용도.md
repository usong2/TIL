# 00 노드로 만들 수 있는 대표적인 서버와 용도

## 00-1 서버는 왜 필요할까?

최근에 안드로이드(Android)나 아이오에스(iOS) 기반의 모바일 앱을 만드는 개발자는 서버에 대한 지식이 전혀 없는 상태로 웹 서버나 채팅 서버를 만들기도 합니다. 이런 경우라도 책 내용대로 서버를 만들다 보면 필요했던 서버 기능을 대부분 문제 없이 만들 수 있을 것입니다. 그렇다면 노드가 무엇인지 배우기 전에 서버가 무엇이며, 어떤 종류의 서버가 있는지 알고 있어야겠죠? 먼저 서버에 대해 간단히 알아본 후 서버의 기능을 하나씩 설명하겠습니다. 

우리는 PC나 스마트폰에서 여러 가지 프로그램(Program)을 사용합니다. 이 프로그램을 **애플리케이션(Application)**이라고 부르며, 스마트폰에서는 **앱(App)**이라고도 부릅니다. PC에서 동작하는 프로그램 중 대포적인 것이 파워포인트, 워드, 엑셀과 같은 문서 프로그램인데 이런 프로그램은 사용법만 익혀도 충분합니다. 하지만 PC나 스마트폰에서 동작하는 프로그램을 직접 만들어보고 싶다면 **API(Application Programming Interface)**를 알아야 합니다. 

API란 프로그램을 쉽게 제작할 수 있게 미리 만들어 놓은 것들의 모음이라고 할 수 있습니다. 예를 들면, 윈도우(Windows)라는 PC용 운영체제(OS)에서 동작하는 프로그램을 쉽게 만들 수 있도록 윈도우용 API가 제공됩니다. 윈도우용 API에는 PC 화면에 버튼처럼 보이는 것들을 미리 만들어 넣어두었기 때문에 간단한 코드 몇 줄로도 버튼을 만들 수 있습니다. 스마트폰의 경우에도 안드로이드 OS나 아이폰용 OS를 위한 API가 있습니다. 이렇게 우리는 운영체제의 API를 이용해서 하나의 단말 기기(Device)에서 동작하는 프로그램을 만들게 됩니다. 

요즘에는 인터넷을 이용해서 다른 장소에 있는 데이터를 가져와 보여주는 경우가 많습니다. 인터넷 익스플로러나 크롬 웹 브라우저를 열고 구글이나 네이버 같은 포털 사이트에 접속하는 것도 웹 브라우저라는 프로그램이 인터넷을 사용해서 웹 서버에 웹 문서를 달라고 요청할 수 있기 때문에 가능한 것입니다. 

여러분이 프로그램을 만들 때도 인터넷을 이용해서 다른 곳의 데이터를 가져와 보여주거나 다른 곳에서 보내온 데이터를 여러분의 컴퓨터에 저장하는 경우가 많이 생깁니다. 이렇게 다른 곳에 있는 단말에 데이터를 달라고 요청하는 프로그램을 **클라이언트(Client)**, 다른 곳에서 요청 받은 명령을 처리해 주는 프로그램을 **서버(Server)**라고 합니다. 

여러분이 만든 프로그램을 인터넷에 연결하기 위해서는 단말에 **네트워크 카드(Network Card 또는 Ethernet Card)**가 들어있어야 합니다. 요즘에는 유선 인터넷뿐만 아니라 무선 인터넷을 사용하는 경우가 많아서 단말에는 와이파이(WiFi)나 3G/LTE로 인터넷에 접속할 수 있는 네트워크 카드가 들어 있습니다. 두 개의 서로 다른 단말에 모두 네트워크 카드가 들어 있다면 한쪽은 클라이언트, 다른 한쪽은 서버 역할을 할 수 있습니다. 이때 서버는 포트(Port)를 지정하여 그 포트로 요청을 받을 수 있습니다. 하나의 단말에서 사용할 수 있는 포트는 보통 0~65535 중 하나를 지정해서 사용하는데 각 포트 영역은 다음과 같이 구분됩니다. 

<table>
    <thead>
    	<tr>
        	<th>포트 번호</th>
        	<th>설명</th>
        </tr>
    </thead>
    <tbody>
    	<tr>
        	<td>0번 ~ 1023번</td>
        	<td>잘 알려진 포트(Well-known port)</td>
        </tr>
        <tr>
        	<td>1024번 ~ 49151번</td>
        	<td>등록된 포트(Registered port)</td>
        </tr>
        <tr>
        	<td>49152번 ~ 65535번</td>
            <td>동적 포트(Dynamic port)</td>
        </tr>
    </tbody>
</table>

> **포트란? **
>
> 단말에 접속하기 위한 '논리적인 접속 위치'입니다. 즉, 인터넷을 사용할 때는 클라이언트 프로그램은 서버의 프로그램이 지정하는 포트로 접속하게 됩니다. 

윈도우나 안드로이드 같은 OS가 시작될 때는 이미 잘 알려진 포트(0~1023번)에서 대부분을 사용합니다. 따라서 여러번이 직접 만드는 서버 프로그램은 보통 1024번 이상의 포트 번호를 사용합니다. 

서버를 만들어 실행하면 지정된 포트에서 클라이언트로부터 요청을 받아 처리하게 됩니다. 또한 많은 경우에 서버는 데이터베이스에 연결할 수 있도록 구성되기 때문에 클라이언트에서 보내온 데이터를 저장하거나 저장된 데이터를 조회한 후 클라이언트에 보내 줍니다. 서버 중에서 여러분이 많이 사용하는 웹 브라우저에서 접속하는 서버를 **웹 서버**라고 하며, HTTP 프로토콜을 사용합니다. 

여기에서 **프로토콜(Protocol)**이란 데이터를 서로 어떤 형태로 주고받을 것인지를 정한 것으로, 간단하게 데이터의 형태라고 생각하면 이해하기 쉽습니다. 따라서 HTTP란 인터넷상에서 데이터를 어떻게 주고받으면 되는지를 정의해 둔 것이고 모든 웹 브라우저가 이 방식을 따른다고 할 수 있습니다. 웹 브라우저에서 HTTP로 요청한 데이터를 받은 웹 서버는 필요한 작업을 수행한 후 HTTP로 응답을 보냅니다. 웹 브라우저에서 볼 수 있는 웹 문서는 보통 HTML과 CSS, 그리고 자바스크립트를 이용해서 만들어 둔 것입니다. 웹 브라우저가 웹 서버로부터 데이터를 전달받으면 웹 브라우저 화면에 웹 문서를 띄우게 되는데, 이 웹 문서가 클라이언트 프로그램의 역할을 하게 됩니다. 따라서 한번 화면에 띄운 웹 문서는 필요할 때마다 웹 서버로 또 다른 웹 문서를 요청하여 받아옵니다. 

스마트폰과 같은 모바일 단말에서는 웹 문서를 웹 서버가 아닌 단말 내부에 저장해 두었다가 화면에 띄운 후 웹 서버로 필요한 데이터만 요청하는 방식을 사용하기도 합니다. 이때 **에이잭스(Ajax)** 방식으로 데이터만 받아오는 경우가 많습니다. 이렇게 하면 매번 웹 문서를 가져오지 않고 필요한 데이터만 가져온 후 화면을 부분적으로 갱신(Refresh)할 수 있기 때문에 화면 처리 속도가 빨라지는 장점이 생깁니다. 

> **에이잭스(Ajax)**
>
> 비동기식 자바스크립트 XML(Asynchronous Javascript And XML)의 약자로 웹 서버에서 웹 문서를 받아오는 것이 아니라 데이터만 받아오기 위한 방법과 기술을 말합니다. 

지금까지 클라이언트와 서버에 대해 간략하게 설명했습니다. 서버에 대해 조금이나마 이해를 했다면 인터넷 환경에서 가장 많이 사용하는 서버가 웹 브라우저에서 접속하는 웹 서버라는 것도 이해했을 것입니다. 

<br>

<hr>

## 00-2 대표적인 서버 유형은 어떤 것이 있을까?

서버의 유형은 굉장히 다양합니다. 따라서 만들려는 애플리케이션이 무엇인지에 따라 필요한 서버 유형이 달라집니다. 예를 들어, 카카오톡이나 라인처럼 실시간 채팅 앱을 만들고 싶다면 실시간 채팅 기능을 지원하는 채팅 서버가 있어야 합니다. 그리고 다양한 센서로부터 값을 전달받아 동작하는 **사물인터넷(IOT, Internet Of Things)** 기능을 만들고 싶다면 여러 센서들과 데이터를 주고받을 수 있는 서버가 있어야 합니다. 요즘에는 모바일 앱을 많이 만들기 때문에 스마트폰과 같은 모바일 단말에 필요한 기능을 제공하는 모바일 서버가 필요합니다. 

+ 클라이언트
  + 웹사이트 조회
  + 실시간 채팅
  + 근처 커피숍 찾기
  + 모바일 단말 관리
  + 데이터 요청
+ 서버
  + 채팅서버
  + 위치 기반 서비스 서버
  + 모바일 서버
  + JSON-RPC 서버
  + 웹 서버
    + 익스프레스
    + 몽고디비
    + 뷰 템플릿
    + 패스포트

<br>

서버의 유형은 크게 다섯 가지로 나뉘어 있습니다. 웹 서버는 모든 서버의 기본입니다. HTTP 프로토콜로 데이터를 주고받을 수 있는 웹 서버를 만들고 나면 그 위에 채팅 서버나 위치 기반 서비스 서버 등을 위한 기능을 추가해서 새로운 서버를 만들 수 있습니다. 

<br>

<hr>

## 00-3 웹 서버의 기능은 무엇일까?

웹 서버는 웹 브라우저에서 웹 문서를 요청할 때 필요한 기능을 수행합니다. 먼저 노드에서 서버를 만들기 위해 노드에서 제공하는 다양한 **모듈(Module)**을 사용하여 웹 서버를 만들어 볼 것입니다. 앞에서 살펴본 서버 유형을 다시 한 번 확인한 다음 언제, 어디서, 무엇을 위해 웹 서버를 사용할지 스스로 체크해 보세요.

<br>

### 누가?

- [ ] 웹 디자이너
- [ ] 웹 퍼블리셔
- [ ] 웹 개발자

<br>


### 언제?

- [ ] 웹 서비스 프로젝트
- [ ] 기업 업무 개발 프로젝트

<br>


### 어디에?

- [ ] 홈페이지
- [ ] 쇼핑몰 사이트
- [ ] 기업 업무 페이지

<br>

여기에서는 서버가 어떻게 동작하는지 간단히 알아보고 넘어가겠습니다. 이제부터 만들 웹 서버는 웹 프레임워크인 **익스프레스(Express)**로 기본 구조를 만들고 **몽고디비(MongoDB)**를 이용해서 데이터를 저장하거나 조회합니다. **뷰 템플릿(View Template)**은 클라이언트에 응답을 보낼 때 사용하려고 미리 웹 문서의 원형(Template)을 만들어 놓은 것이며, **패스포트(Passport)**는 사용자 로그인이나 회원가입을 위해 사용합니다. 그렇다면 이런 것들을 사용해 만드는 웹 서버의 주요 기능은 무엇일까요? 

웹 브라우저에서 `http://localhost:3000/login.html`과 같은 사이트 주소를 입력하고 웹 서버에 요청하면 웹 서버는 미리 만들어 둔 웹 문서를 보내줍니다. **localhost(로컬 호스트)**는 PC 자신을 나타내는 인터넷 주소라고 할 수 있습니다. 인터넷상에 있는 다른 PC나 단말에 연결하려고 할 때 IP와 같은 단말 주소를 사용하는데, 이때 다른 단말이 아닌 자기 자신을 가리킬 때 localhost라고 합니다. 서버 기능을 만든 후 테스트할 때 다른 단말로 연결하려면 그 단말이 있어야 하므로 실습 중인 PC에서 서버 기능을 테스트할 수 있도록 localhost라는 주소를 자주 사용합니다. 

<br>

### 웹 서버

#### 주요 기능 

+ 웹 문서 조회
+ 파일 업로드/다운로드
+ 로그인/회원가입

<br>

#### 구성

+ 익스프레스 : 웹 서버에 필요한 파일들을 자동 생성
+ 몽고디비 : 데이터 저장, 조회
+ 뷰 템플릿 : 클라이언트에 응답
+ 패스포트 : 로그인 회원 가입 기능 용이

<br>

<hr>

## 00-4 채팅 서버의 중요한 기능은 무엇일까?

채팅 서버는 일대일(1:1) 채팅이나 그룹 채팅처럼 실시간 채팅 기능을 클라이언트에서 사용하고 싶을 때 만듭니다. 웹 브라우저나 모바일 단말 같은 클라이언트에서 채팅 메시지를 채팅 서버에 보내면 채팅 서버는 이 메시지를 누구에게 전달할 것인지를 결정한 후 응답을 보냅니다. 어떤 목적으로 언제, 어디에서 채팅 서버를 사용하려고 하는지 체크해 보세요. 

<br>

### 누가?

- [ ] 웹 개발자
- [ ] 모바일 앱 개발자
- [ ] 윈도우 프로그램 개발자

<br>

### 언제?

- [ ] 웹 채팅
- [ ] 스마트폰 채팅
- [ ] 실시간 의견 공유

<br>

### 어디에?

- [ ] 채팅 앱 개발 프로젝트
- [ ] 공유 솔루션 개발 프로젝트

<br>

웹 브라우저나 모바일 앱에서 실시간 채팅 기능을 사용하고 싶다면 먼저 채팅 서버에 접속합니다. 채팅 서버는 웹 서버에 기능을 추가한 형태로 구성되며, 일대일 채팅과 그룹 채팅 기능을 제공합니다. 클라이언트는 채팅을 위해 채팅 서버에 접속한 후 로그인하고 친구 목록을 가져올 수 있습니다. 채팅 메시지를 채팅 서버에 보내면 일대일 채팅의 경우에 상대방을 찾아 메시지를 보내고, 그룹 채팅일 경우에는 대화방에 들어와 있는 모든 사람에게 메시지를 보냅니다. 

<br>

<hr>

## 00-5 JSON-RPC 서버의 중요한 기능은 무엇일까?

**JSON-RPC** 서버는 서버 쪽에 함수를 만들어 두고 클라이언트에서 함수를 호출하듯이 데이터를 요청하면 응답하는 서버입니다. 주로 웹 문서가 아닌 데이터만을 주고받을 때 JSON-RPC 서버를 사용합니다. JSON은 어떤 형식으로 데이터를 주고받을지 정해 놓은 **표준 데이터 포맷**이며, **RPC(Remote Procedure Call)**방식으로 데이터를 주고 받습니다. RPC는 서버 쪽에 함수를 만들어 두고 클아이언트에서 함수를 호출하듯이 데이터를 요청할 수 있도록 만들어 주는 표준입니다. JSON과 RPC 표준을 함께 사용하면 서버 족에 구축해야 하는 기능을 함수별로 명확하게 구분하여 만들 수 있습니다. 이 때문에 서버의 유지 관리가 쉬워집니다. 그리고 클라이언트에서 웹 문서가 아닌 데이터만 요청하는 경우에도 JSON-RPC 서버를 종종 사용합니다. 언제, 어디에서 JSON-RPC 서버를 사용할 것인지 확인해보세요. 

<br>

### 누가?

- [ ] 앱 개발자
- [ ] 윈도우 프로그램 개발자

<br>

### 언제?

- [ ] 기능 중심의 사이트
- [ ] 기업 업무 페이지
- [ ] 스마트폰 앱

<br>

### 어디에?

- [ ] 기업 업무 개발 프로젝트
- [ ] 앱 개발 프로젝트

<br>

웹 브라우저나 앱에서는 일반 함수를 호출하듯이 서버에 등록된 함수를 호출할 수 있습니다. 서버에 등록된 함수를 보통 핸들러라고 부르는데, 더하기나 빼기 같은 계산 기능을 하나의 함수로 만들어 등록하면 클라이언트에서 더하기나 빼기 기능을 호출하여 계산 결과를 받아 볼 수 있습니다. 클라이언트가 웹 서버에 웹 문서를 요청하는 것이 아니라 데이터만 요청하고 싶다면 이 JSON-RPC 서버를 사용하는 것이 훨씬 쉽고 간단합니다. 따라서 데이터를 요청하고 응답을 받아 처리하는 데 에이잭스 방식이 아닌 JSON=RPc를 사용하기도 합니다. 