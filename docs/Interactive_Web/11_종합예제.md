# 종합 예제 - 3D 스크롤

## 기본 구조

+ index.html

  ```html
  <!DOCTYPE html>
  <html>
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <meta http-equiv="X-UA-Compatible" content="ie=edge" />
      <title>3D wall</title>
      <link rel="stylesheet" href="css/reset.css" />
      <link rel="stylesheet" href="css/style.css" />
    </head>
    <body>
      <!-- <div class="progress-bar-con">
        <div class="progress-bar"></div>
      </div>
      <div class="select-character">
        <button
          class="select-character-btn select-character-btn-ilbuni"
          data-char="ilbuni"
        ></button>
        <button
          class="select-character-btn select-character-btn-ragirl"
          data-char="ragirl"
        ></button>
      </div> -->
  
      <div class="world">
        <div class="stage">
          <div class="house">
            <section class="wall wall-left"></section>
            <section class="wall wall-right"></section>
            <section class="wall wall-front wall-front-a">
              <div class="wall-content">
                <h2 class="wall-title">안녕하세요</h2>
              </div>
            </section>
            <section class="wall wall-front wall-front-b">
              <div class="wall-content">
                <h2 class="wall-title">Hello</h2>
              </div>
            </section>
            <section class="wall wall-front wall-front-c">
              <div class="wall-content">
                <h2 class="wall-title">Hola</h2>
              </div>
            </section>
            <section class="wall wall-front wall-front-d">
              <div class="wall-content">
                <h2 class="wall-title">こんにちは</h2>
              </div>
            </section>
          </div>
          <!--// house -->
  
          <!-- 캐릭터 놓이는 곳 -->
        </div>
        <!--// stage -->
      </div>
      <!--// world -->
  
      <script src="js/Character.js"></script>
      <script src="js/wall3d.js"></script>
      <script>
        (function () {
          const useragent = window.navigator.userAgent.toLowerCase();
          if (
            useragent.indexOf("chrome") < 0 &&
            useragent.indexOf("safari") < 0
          ) {
            document.body.style.cssText = "height: auto";
            document.body.innerHTML =
              '<p style="padding: 20px; line-height: 1.6">본 예제는 Full CSS 3D가 사용된 페이지로, webkit 기반 브라우저(크롬, 사파리 등)에서 확인하며 학습하시는게 좋습니다.<br>CSS 3D 부분 외에는 브라우저 상관없이 인터랙티브 웹 페이지 개발을 위해 필수적이고 유용한 내용들을 다루고 있으니 꼭 처음부터 끝까지 공부해 보세요! :)</p>';
          }
        })();
      </script>
    </body>
  </html>
  ```

+ css/style.css

  ```css
  body {
    height: 500vw;
    font-family: "Apple SD Gothic Neo", "Roboto", "Noto Sans KR", NanumGothic,
      "Malgun Gothic", sans-serif;
    -webkit-overflow-scrolling: touch;
    color: #555;
    background: #fff000;
    transition: background 0.5s;
  }
  ```

<br>

## 구조에 3D 설정

```css
body {
  height: 500vw;
  font-family: "Apple SD Gothic Neo", "Roboto", "Noto Sans KR", NanumGothic,
    "Malgun Gothic", sans-serif;
  -webkit-overflow-scrolling: touch;
  color: #555;
  background: #fff000;
  transition: background 0.5s;
}
.world {
  position: fixed;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  perspective: 1000px;
}
.stage {
  position: absolute;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  transform-style: preserve-3d;
}
```

## 벽 설정

```css
body {
  height: 500vw;
  font-family: "Apple SD Gothic Neo", "Roboto", "Noto Sans KR", NanumGothic,
    "Malgun Gothic", sans-serif;
  -webkit-overflow-scrolling: touch;
  color: #555;
  background: #fff000;
  transition: background 0.5s;
}
.world {
  position: fixed;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  perspective: 1000px;
}
.stage {
  position: absolute;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  transform-style: preserve-3d;
}
.house {
  width: 100vw;
  height: 100vh;
  transform-style: preserve-3d;
}
.wall {
  position: absolute;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(255, 255, 255, 0.8);
}
.wall-content {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
}
.wall-title {
  font-size: 5rem;
}
```

## 양쪽 벽

```css
body {
  height: 500vw;
  font-family: "Apple SD Gothic Neo", "Roboto", "Noto Sans KR", NanumGothic,
    "Malgun Gothic", sans-serif;
  -webkit-overflow-scrolling: touch;
  color: #555;
  background: #fff000;
  transition: background 0.5s;
}
.world {
  position: fixed;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  perspective: 1000px;
}
.stage {
  position: absolute;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  transform-style: preserve-3d;
}
.house {
  width: 100vw;
  height: 100vh;
  transform: translateZ(-490vw);
  transform-style: preserve-3d;
}
.wall {
  position: absolute;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(255, 255, 255, 0.8);
}
.wall-left {
  /* left: -500vw; */
  width: 1000vw;
  transform: rotateY(90deg) translateZ(-500vw);
}
.wall-right {
  /* left: -500vw; */
  width: 1000vw;
  /* transform: rotateY(90deg) translateZ(100vw); */
  transform: rotateY(90deg) translateZ(-400vw);
}
.wall-content {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
}
.wall-title {
  font-size: 5rem;
}
```

## 벽 배치

```css
body {
  height: 500vw;
  font-family: "Apple SD Gothic Neo", "Roboto", "Noto Sans KR", NanumGothic,
    "Malgun Gothic", sans-serif;
  -webkit-overflow-scrolling: touch;
  color: #555;
  background: #fff000;
  transition: background 0.5s;
}
.world {
  position: fixed;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  perspective: 1000px;
}
.stage {
  position: absolute;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  transform-style: preserve-3d;
}
.house {
  width: 100vw;
  height: 100vh;
  transform: translateZ(-490vw);
  transform-style: preserve-3d;
}
.wall {
  position: absolute;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(255, 255, 255, 0.8);
}
.wall-left {
  width: 1000vw;
  background: #f8f8f8;
  transform: rotateY(90deg) translateZ(-500vw);
}
.wall-right {
  width: 1000vw;
  background: #f8f8f8;
  transform: rotateY(90deg) translateZ(-400vw);
}
.wall-front-a {
  transform: translateZ(300vw);
}
.wall-front-b {
  transform: translateZ(50vw);
}
.wall-front-c {
  transform: translateZ(-200vw);
}
.wall-front-d {
  transform: translateZ(-500vw);
}
.wall-content {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
}
.wall-title {
  font-size: 5rem;
}
```

## 3D벽 기본 스크롤링

pageYOffset 이용

+ js/wall3d.js

  ```javascript
  (function () {
    const houseElem = document.querySelector(".house");
    let maxScrollValue = document.body.offsetHeight - window.innerHeight; // 전체문서 높이 - 창 높이 = 전체 스크롤 범위
  
    window.addEventListener("scroll", function () {
      const zMove = (this.pageYOffset / maxScrollValue) * 980 - 490;
      houseElem.style.transform = "translateZ(" + zMove + "vw)";
    });
  })();
  ```

## 창 사이즈 변경 대응

height에 의존적이므로 처음에 로드될 때의 높이에서만 움직이고 창 사이즈가 바뀌면 의도적으로 움직이지 않음창 사이즈가 바뀔 때 마다 maxScrollValue 갱신 필요

+ js/wall3d.js

  ```js
  (function () {
    const houseElem = document.querySelector(".house");
    let maxScrollValue;
  
    function resizeHandler() {
      maxScrollValue = document.body.offsetHeight - window.innerHeight;
    }
  
    window.addEventListener("scroll", function () {
      const zMove = (this.pageYOffset / maxScrollValue) * 980 - 490;
      houseElem.style.transform = "translateZ(" + zMove + "vw)";
    });
  
    window.addEventListener("resize", resizeHandler);
    resizeHandler();
  })();
  ```

## Progress Bar 만들기

+ index.html

  ```html
  <!DOCTYPE html>
  <html>
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <meta http-equiv="X-UA-Compatible" content="ie=edge" />
      <title>3D wall</title>
      <link rel="stylesheet" href="css/reset.css" />
      <link rel="stylesheet" href="css/style.css" />
    </head>
    <body>
      <div class="progress-bar-con">
        <div class="progress-bar"></div>
      </div>
      <!-- <div class="select-character">
        <button
          class="select-character-btn select-character-btn-ilbuni"
          data-char="ilbuni"
        ></button>
        <button
          class="select-character-btn select-character-btn-ragirl"
          data-char="ragirl"
        ></button>
      </div> -->
  
      <div class="world">
        <div class="stage">
          <div class="house">
            <section class="wall wall-left"></section>
            <section class="wall wall-right"></section>
            <section class="wall wall-front wall-front-a">
              <div class="wall-content">
                <h2 class="wall-title">안녕하세요</h2>
              </div>
            </section>
            <section class="wall wall-front wall-front-b">
              <div class="wall-content">
                <h2 class="wall-title">Hello</h2>
              </div>
            </section>
            <section class="wall wall-front wall-front-c">
              <div class="wall-content">
                <h2 class="wall-title">Hola</h2>
              </div>
            </section>
            <section class="wall wall-front wall-front-d">
              <div class="wall-content">
                <h2 class="wall-title">こんにちは</h2>
              </div>
            </section>
          </div>
          <!--// house -->
  
          <!-- 캐릭터 놓이는 곳 -->
        </div>
        <!--// stage -->
      </div>
      <!--// world -->
  
      <script src="js/Character.js"></script>
      <script src="js/wall3d.js"></script>
      <script>
        (function () {
          const useragent = window.navigator.userAgent.toLowerCase();
          if (
            useragent.indexOf("chrome") < 0 &&
            useragent.indexOf("safari") < 0
          ) {
            document.body.style.cssText = "height: auto";
            document.body.innerHTML =
              '<p style="padding: 20px; line-height: 1.6">본 예제는 Full CSS 3D가 사용된 페이지로, webkit 기반 브라우저(크롬, 사파리 등)에서 확인하며 학습하시는게 좋습니다.<br>CSS 3D 부분 외에는 브라우저 상관없이 인터랙티브 웹 페이지 개발을 위해 필수적이고 유용한 내용들을 다루고 있으니 꼭 처음부터 끝까지 공부해 보세요! :)</p>';
          }
        })();
      </script>
    </body>
  </html>
  ```

+ css/style.css

  ```css
  .progress-bar-con {
    position: fixed;
    left: 0;
    top: 0;
    z-index: 100;
    width: 100vw;
    height: 5px;
    background: #555;
  }
  .progress-bar {
    width: 0;
    height: 100%;
    background: #00a8ff;
  }
  ```

+ js/wall3d.js

  ```js
  (function () {
    const houseElem = document.querySelector(".house");
    const barElem = document.querySelector(".progress-bar");
    let maxScrollValue;
  
    function resizeHandler() {
      maxScrollValue = document.body.offsetHeight - window.innerHeight;
    }
  
    window.addEventListener("scroll", function () {
      const scrollPer = pageYOffset / maxScrollValue;
      const zMove = scrollPer * 980 - 490;
      houseElem.style.transform = "translateZ(" + zMove + "vw)";
  
      // progress bar
      barElem.style.width = scrollPer * 100 + "%";
    });
  
    window.addEventListener("resize", resizeHandler);
    resizeHandler();
  })();
  ```

## 마우스 위치에 따른 시점 변경

+ js/wall3d.js

  ```js
  (function () {
    const stageElem = document.querySelector(".stage");
    const houseElem = document.querySelector(".house");
    const barElem = document.querySelector(".progress-bar");
    const mousePos = { x: 0, y: 0 };
    let maxScrollValue;
  
    function resizeHandler() {
      maxScrollValue = document.body.offsetHeight - window.innerHeight;
    }
  
    window.addEventListener("scroll", function () {
      const scrollPer = pageYOffset / maxScrollValue;
      const zMove = scrollPer * 980 - 490;
      houseElem.style.transform = "translateZ(" + zMove + "vw)";
  
      // progress bar
      barElem.style.width = scrollPer * 100 + "%";
    });
  
    window.addEventListener("mousemove", function (e) {
      mousePos.x = -1 + (e.clientX / window.innerWidth) * 2;
      mousePos.y = 1 - (e.clientY / window.innerHeight) * 2;
      stageElem.style.transform =
        "rotateX(" + mousePos.y * 5 + "deg) rotateY(" + mousePos.x * 5 + "deg)";
    });
  
    window.addEventListener("resize", resizeHandler);
    resizeHandler();
  })();
  ```

## 캐릭터 구조

+ index.html

  ```html
  <!DOCTYPE html>
  <html>
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <meta http-equiv="X-UA-Compatible" content="ie=edge" />
      <title>3D wall</title>
      <link rel="stylesheet" href="css/reset.css" />
      <link rel="stylesheet" href="css/style.css" />
    </head>
    <body>
      <div class="progress-bar-con">
        <div class="progress-bar"></div>
      </div>
      <!-- <div class="select-character">
        <button
          class="select-character-btn select-character-btn-ilbuni"
          data-char="ilbuni"
        ></button>
        <button
          class="select-character-btn select-character-btn-ragirl"
          data-char="ragirl"
        ></button>
      </div> -->
  
      <div class="world">
        <div class="stage">
          <div class="house">
            <section class="wall wall-left"></section>
            <section class="wall wall-right"></section>
            <section class="wall wall-front wall-front-a">
              <div class="wall-content">
                <h2 class="wall-title">안녕하세요</h2>
              </div>
            </section>
            <section class="wall wall-front wall-front-b">
              <div class="wall-content">
                <h2 class="wall-title">Hello</h2>
              </div>
            </section>
            <section class="wall wall-front wall-front-c">
              <div class="wall-content">
                <h2 class="wall-title">Hola</h2>
              </div>
            </section>
            <section class="wall wall-front wall-front-d">
              <div class="wall-content">
                <h2 class="wall-title">こんにちは</h2>
              </div>
            </section>
          </div>
          <!--// house -->
  
          <!-- 캐릭터 놓이는 곳 -->
          <div class="character">
            <div class="character-face-con character-head">
              <div class="character-face character-head-face face-front"></div>
              <div class="character-face character-head-face face-back"></div>
            </div>
            <div class="character-face-con character-torso">
              <div class="character-face character-torso-face face-front"></div>
              <div class="character-face character-torso-face face-back"></div>
            </div>
            <div class="character-face-con character-arm character-arm-right">
              <div class="character-face character-arm-face face-front"></div>
              <div class="character-face character-arm-face face-back"></div>
            </div>
            <div class="character-face-con character-arm character-arm-left">
              <div class="character-face character-arm-face face-front"></div>
              <div class="character-face character-arm-face face-back"></div>
            </div>
            <div class="character-face-con character-leg character-leg-right">
              <div class="character-face character-leg-face face-front"></div>
              <div class="character-face character-leg-face face-back"></div>
            </div>
            <div class="character-face-con character-leg character-leg-left">
              <div class="character-face character-leg-face face-front"></div>
              <div class="character-face character-leg-face face-back"></div>
            </div>
          </div>
        </div>
        <!--// stage -->
      </div>
      <!--// world -->
  
      <script src="js/Character.js"></script>
      <script src="js/wall3d.js"></script>
      <script>
        (function () {
          const useragent = window.navigator.userAgent.toLowerCase();
          if (
            useragent.indexOf("chrome") < 0 &&
            useragent.indexOf("safari") < 0
          ) {
            document.body.style.cssText = "height: auto";
            document.body.innerHTML =
              '<p style="padding: 20px; line-height: 1.6">본 예제는 Full CSS 3D가 사용된 페이지로, webkit 기반 브라우저(크롬, 사파리 등)에서 확인하며 학습하시는게 좋습니다.<br>CSS 3D 부분 외에는 브라우저 상관없이 인터랙티브 웹 페이지 개발을 위해 필수적이고 유용한 내용들을 다루고 있으니 꼭 처음부터 끝까지 공부해 보세요! :)</p>';
          }
        })();
      </script>
    </body>
  </html>
  ```

+ css/style.css

  ```css
  body {
    height: 500vw;
    font-family: "Apple SD Gothic Neo", "Roboto", "Noto Sans KR", NanumGothic,
      "Malgun Gothic", sans-serif;
    -webkit-overflow-scrolling: touch;
    color: #555;
    background: #fff000;
    transition: background 0.5s;
  }
  .world {
    position: fixed;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    perspective: 1000px;
  }
  .stage {
    position: absolute;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    transform-style: preserve-3d;
  }
  .house {
    width: 100vw;
    height: 100vh;
    transform: translateZ(-490vw);
    transform-style: preserve-3d;
  }
  .wall {
    position: absolute;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.8);
  }
  .wall-left {
    width: 1000vw;
    background: #f8f8f8;
    transform: rotateY(90deg) translateZ(-500vw);
  }
  .wall-right {
    width: 1000vw;
    background: #f8f8f8;
    transform: rotateY(90deg) translateZ(-400vw);
  }
  .wall-front-a {
    transform: translateZ(300vw);
  }
  .wall-front-b {
    transform: translateZ(50vw);
  }
  .wall-front-c {
    transform: translateZ(-200vw);
  }
  .wall-front-d {
    transform: translateZ(-500vw);
  }
  .wall-content {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }
  .wall-title {
    font-size: 5rem;
  }
  .progress-bar-con {
    position: fixed;
    left: 0;
    top: 0;
    z-index: 100;
    width: 100vw;
    height: 5px;
    background: #555;
  }
  .progress-bar {
    width: 0;
    height: 100%;
    background: #00a8ff;
  }
  
  /* character */
  .character {
    position: absolute;
    left: 12%;
    bottom: 5%;
    width: 10vw;
    height: 15.58vw;
    transform-style: preserve-3d;
  }
  .character[data-direction="forward"] {
    transform: rotateY(180deg);
  }
  .character[data-direction="backword"] {
    transform: rotateY(0deg);
  }
  .character[data-direction="left"] {
    transform: rotateY(-90deg);
  }
  .character[data-direction="right"] {
    transform: rotateY(90deg);
  }
  .character-face-con {
    position: absolute;
    transform-style: preserve-3d;
    transition: 1s;
  }
  .character-face {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-repeat: no-repeat;
    background-position: 0 0;
    background-size: cover;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }
  .character-face.face-back {
    transform: rotateY(180deg);
  }
  .character-head {
    left: calc(42 / 856 * 100%);
    top: 0;
    z-index: 60;
    width: calc(770 / 856 * 100%);
    height: calc(648 / 1334 * 100%);
    transform-origin: center bottom;
    animation: ani-head 0.6s infinite alternate
      cubic-bezier(0.46, 0.18, 0.66, 0.93);
  }
  .character-head-face.face-front {
    background-image: url("../images/ilbuni_head_front.png");
  }
  .character-head-face.face-back {
    background-image: url("../images/ilbuni_head_back.png");
  }
  .character-torso {
    left: calc(208 / 856 * 100%);
    top: calc(647 / 1334 * 100%);
    z-index: 50;
    width: calc(428 / 856 * 100%);
    height: calc(385 / 1334 * 100%);
    transform-origin: center center;
  }
  .character-torso-face.face-front {
    background-image: url("../images/ilbuni_body_front.png");
  }
  .character-torso-face.face-back {
    background-image: url("../images/ilbuni_body_back.png");
  }
  .character-arm-right {
    left: 0;
    top: calc(648 / 1334 * 100%);
    width: calc(244 / 856 * 100%);
    height: calc(307 / 1334 * 100%);
    transform-origin: right top;
  }
  .character-arm-right .face-front {
    background-image: url("../images/ilbuni_arm_0.png");
  }
  .character-arm-right .face-back {
    background-image: url("../images/ilbuni_arm_1.png");
  }
  .character-arm-left {
    left: calc(600 / 856 * 100%);
    top: calc(648 / 1334 * 100%);
    width: calc(244 / 856 * 100%);
    height: calc(307 / 1334 * 100%);
    transform-origin: left top;
  }
  .character-arm-left .face-front {
    background-image: url("../images/ilbuni_arm_1.png");
  }
  .character-arm-left .face-back {
    background-image: url("../images/ilbuni_arm_0.png");
  }
  .character-leg-right {
    left: calc(200 / 856 * 100%);
    top: calc(1031 / 1334 * 100%);
    width: calc(230 / 856 * 100%);
    height: calc(300 / 1334 * 100%);
    transform-origin: center top;
  }
  .character-leg-right .face-front {
    background-image: url("../images/ilbuni_leg_0.png");
  }
  .character-leg-right .face-back {
    background-image: url("../images/ilbuni_leg_1.png");
  }
  .character-leg-left {
    left: calc(414 / 856 * 100%);
    top: calc(1031 / 1334 * 100%);
    width: calc(230 / 856 * 100%);
    height: calc(300 / 1334 * 100%);
    transform-origin: center top;
  }
  .character-leg-left .face-front {
    background-image: url("../images/ilbuni_leg_1.png");
  }
  .character-leg-left .face-back {
    background-image: url("../images/ilbuni_leg_0.png");
  }
  .character.running .character-leg-right {
    animation: ani-running-leg 0.2s alternate infinite linear;
  }
  .character.running .character-leg-left {
    animation: ani-running-leg 0.2s alternate-reverse infinite linear;
  }
  .character.running .character-arm {
    animation: ani-running-arm 0.2s alternate infinite linear;
  }
  ```

## 캐릭터 머리 움직이기

+ css/style.css

  ```css
  @keyframes ani-head {
    to {
      transform: rotateX(-10deg);
    }
  }
  
  body {
    height: 500vw;
    font-family: "Apple SD Gothic Neo", "Roboto", "Noto Sans KR", NanumGothic,
      "Malgun Gothic", sans-serif;
    -webkit-overflow-scrolling: touch;
    color: #555;
    background: #fff000;
    transition: background 0.5s;
  }
  .world {
    position: fixed;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    perspective: 1000px;
  }
  .stage {
    position: absolute;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    transform-style: preserve-3d;
  }
  .house {
    width: 100vw;
    height: 100vh;
    transform: translateZ(-490vw);
    transform-style: preserve-3d;
  }
  .wall {
    position: absolute;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.8);
  }
  .wall-left {
    width: 1000vw;
    background: #f8f8f8;
    transform: rotateY(90deg) translateZ(-500vw);
  }
  .wall-right {
    width: 1000vw;
    background: #f8f8f8;
    transform: rotateY(90deg) translateZ(-400vw);
  }
  .wall-front-a {
    transform: translateZ(300vw);
  }
  .wall-front-b {
    transform: translateZ(50vw);
  }
  .wall-front-c {
    transform: translateZ(-200vw);
  }
  .wall-front-d {
    transform: translateZ(-500vw);
  }
  .wall-content {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }
  .wall-title {
    font-size: 5rem;
  }
  .progress-bar-con {
    position: fixed;
    left: 0;
    top: 0;
    z-index: 100;
    width: 100vw;
    height: 5px;
    background: #555;
  }
  .progress-bar {
    width: 0;
    height: 100%;
    background: #00a8ff;
  }
  
  /* character */
  .character {
    position: absolute;
    left: 12%;
    bottom: 5%;
    width: 10vw;
    height: 15.58vw;
    transform-style: preserve-3d;
  }
  .character[data-direction="forward"] {
    transform: rotateY(180deg);
  }
  .character[data-direction="backword"] {
    transform: rotateY(0deg);
  }
  .character[data-direction="left"] {
    transform: rotateY(-90deg);
  }
  .character[data-direction="right"] {
    transform: rotateY(90deg);
  }
  .character-face-con {
    position: absolute;
    transform-style: preserve-3d;
    transition: 1s;
  }
  .character-face {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-repeat: no-repeat;
    background-position: 0 0;
    background-size: cover;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }
  .character-face.face-back {
    transform: rotateY(180deg);
  }
  .character-head {
    left: calc(42 / 856 * 100%);
    top: 0;
    z-index: 60;
    width: calc(770 / 856 * 100%);
    height: calc(648 / 1334 * 100%);
    transform-origin: center bottom;
    animation: ani-head 0.6s infinite alternate
      cubic-bezier(0.46, 0.18, 0.66, 0.93);
  }
  .character-head-face.face-front {
    background-image: url("../images/ilbuni_head_front.png");
  }
  .character-head-face.face-back {
    background-image: url("../images/ilbuni_head_back.png");
  }
  .character-torso {
    left: calc(208 / 856 * 100%);
    top: calc(647 / 1334 * 100%);
    z-index: 50;
    width: calc(428 / 856 * 100%);
    height: calc(385 / 1334 * 100%);
    transform-origin: center center;
  }
  .character-torso-face.face-front {
    background-image: url("../images/ilbuni_body_front.png");
  }
  .character-torso-face.face-back {
    background-image: url("../images/ilbuni_body_back.png");
  }
  .character-arm-right {
    left: 0;
    top: calc(648 / 1334 * 100%);
    width: calc(244 / 856 * 100%);
    height: calc(307 / 1334 * 100%);
    transform-origin: right top;
  }
  .character-arm-right .face-front {
    background-image: url("../images/ilbuni_arm_0.png");
  }
  .character-arm-right .face-back {
    background-image: url("../images/ilbuni_arm_1.png");
  }
  .character-arm-left {
    left: calc(600 / 856 * 100%);
    top: calc(648 / 1334 * 100%);
    width: calc(244 / 856 * 100%);
    height: calc(307 / 1334 * 100%);
    transform-origin: left top;
  }
  .character-arm-left .face-front {
    background-image: url("../images/ilbuni_arm_1.png");
  }
  .character-arm-left .face-back {
    background-image: url("../images/ilbuni_arm_0.png");
  }
  .character-leg-right {
    left: calc(200 / 856 * 100%);
    top: calc(1031 / 1334 * 100%);
    width: calc(230 / 856 * 100%);
    height: calc(300 / 1334 * 100%);
    transform-origin: center top;
  }
  .character-leg-right .face-front {
    background-image: url("../images/ilbuni_leg_0.png");
  }
  .character-leg-right .face-back {
    background-image: url("../images/ilbuni_leg_1.png");
  }
  .character-leg-left {
    left: calc(414 / 856 * 100%);
    top: calc(1031 / 1334 * 100%);
    width: calc(230 / 856 * 100%);
    height: calc(300 / 1334 * 100%);
    transform-origin: center top;
  }
  .character-leg-left .face-front {
    background-image: url("../images/ilbuni_leg_1.png");
  }
  .character-leg-left .face-back {
    background-image: url("../images/ilbuni_leg_0.png");
  }
  .character.running .character-leg-right {
    animation: ani-running-leg 0.2s alternate infinite linear;
  }
  .character.running .character-leg-left {
    animation: ani-running-leg 0.2s alternate-reverse infinite linear;
  }
  .character.running .character-arm {
    animation: ani-running-arm 0.2s alternate infinite linear;
  }
  
  body[data-char="ragirl"] .character {
    width: 12vw;
    height: calc(12vw * 1.4135);
  }
  body[data-char="ragirl"] .character-head {
    left: calc(23 / 948 * 100%);
    width: calc(920 / 948 * 100%);
    height: calc(750 / 1340 * 100%);
  }
  body[data-char="ragirl"] .character-head-face.face-front {
    background-image: url("../images/ragirl_head_front.png");
  }
  body[data-char="ragirl"] .character-head-face.face-back {
    background-image: url("../images/ragirl_head_back.png");
  }
  body[data-char="ragirl"] .character-torso {
    left: calc(273 / 948 * 100%);
    top: calc(630 / 1340 * 100%);
    z-index: 50;
    width: calc(402 / 948 * 100%);
    height: calc(444 / 1340 * 100%);
    transform-origin: center center;
  }
  body[data-char="ragirl"] .character-torso-face.face-front {
    background-image: url("../images/ragirl_body_front.png");
  }
  body[data-char="ragirl"] .character-torso-face.face-back {
    background-image: url("../images/ragirl_body_back.png");
  }
  body[data-char="ragirl"] .character-arm-right {
    left: calc(134 / 948 * 100%);
    top: calc(709 / 1340 * 100%);
    width: calc(138 / 948 * 100%);
    height: calc(300 / 1340 * 100%);
    transform-origin: right top;
  }
  body[data-char="ragirl"] .character-arm-right .face-front {
    background-image: url("../images/ragirl_arm_0_front.png");
  }
  body[data-char="ragirl"] .character-arm-right .face-back {
    background-image: url("../images/ragirl_arm_1_back.png");
  }
  body[data-char="ragirl"] .character-arm-left {
    left: calc(675 / 948 * 100%);
    top: calc(709 / 1340 * 100%);
    width: calc(138 / 948 * 100%);
    height: calc(300 / 1340 * 100%);
    transform-origin: left top;
  }
  body[data-char="ragirl"] .character-arm-left .face-front {
    background-image: url("../images/ragirl_arm_1_front.png");
  }
  body[data-char="ragirl"] .character-arm-left .face-back {
    background-image: url("../images/ragirl_arm_0_back.png");
  }
  body[data-char="ragirl"] .character-leg-right {
    left: calc(290 / 948 * 100%);
    top: calc(1075 / 1340 * 100%);
    width: calc(186 / 948 * 100%);
    height: calc(264 / 1340 * 100%);
    transform-origin: center top;
  }
  body[data-char="ragirl"] .character-leg-right .face-front {
    background-image: url("../images/ragirl_leg_0.png");
  }
  body[data-char="ragirl"] .character-leg-right .face-back {
    background-image: url("../images/ragirl_leg_1.png");
  }
  body[data-char="ragirl"] .character-leg-left {
    left: calc(474 / 948 * 100%);
    top: calc(1075 / 1340 * 100%);
    width: calc(186 / 948 * 100%);
    height: calc(264 / 1340 * 100%);
    transform-origin: center top;
  }
  body[data-char="ragirl"] .character-leg-left .face-front {
    background-image: url("../images/ragirl_leg_1.png");
  }
  body[data-char="ragirl"] .character-leg-left .face-back {
    background-image: url("../images/ragirl_leg_0.png");
  }
  ```

## 캐릭터 생성하기

+ js/Character.js

  ```js
  function Character() {
    this.mainElem = document.createElement("div");
    this.mainElem.classList.add("character");
    this.mainElem.innerHTML =
      "" +
      '<div class="character-face-con character-head">' +
      '<div class="character-face character-head-face face-front"></div>' +
      '<div class="character-face character-head-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-torso">' +
      '<div class="character-face character-torso-face face-front"></div>' +
      '<div class="character-face character-torso-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-right">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-left">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-right">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-left">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>";
  
    document.querySelector(".stage").appendChild(this.mainElem);
  }
  ```

+ js/wall3d.js

  ```js
  (function () {
    const stageElem = document.querySelector(".stage");
    const houseElem = document.querySelector(".house");
    const barElem = document.querySelector(".progress-bar");
    const mousePos = { x: 0, y: 0 };
    let maxScrollValue;
  
    function resizeHandler() {
      maxScrollValue = document.body.offsetHeight - window.innerHeight;
    }
  
    window.addEventListener("scroll", function () {
      const scrollPer = pageYOffset / maxScrollValue;
      const zMove = scrollPer * 980 - 490;
      houseElem.style.transform = "translateZ(" + zMove + "vw)";
  
      // progress bar
      barElem.style.width = scrollPer * 100 + "%";
    });
  
    window.addEventListener("mousemove", function (e) {
      mousePos.x = -1 + (e.clientX / window.innerWidth) * 2;
      mousePos.y = 1 - (e.clientY / window.innerHeight) * 2;
      stageElem.style.transform =
        "rotateX(" + mousePos.y * 5 + "deg) rotateY(" + mousePos.x * 5 + "deg)";
    });
  
    window.addEventListener("resize", resizeHandler);
    resizeHandler();
  
    new Character();
  })();
  ```

## 캐릭터 클릭 위치 생성하기

+ js/wall3d.js

  ```js
  (function () {
    const stageElem = document.querySelector(".stage");
    const houseElem = document.querySelector(".house");
    const barElem = document.querySelector(".progress-bar");
    const mousePos = { x: 0, y: 0 };
    let maxScrollValue;
  
    function resizeHandler() {
      maxScrollValue = document.body.offsetHeight - window.innerHeight;
    }
  
    window.addEventListener("scroll", function () {
      const scrollPer = pageYOffset / maxScrollValue;
      const zMove = scrollPer * 980 - 490;
      houseElem.style.transform = "translateZ(" + zMove + "vw)";
  
      // progress bar
      barElem.style.width = scrollPer * 100 + "%";
    });
  
    window.addEventListener("mousemove", function (e) {
      mousePos.x = -1 + (e.clientX / window.innerWidth) * 2;
      mousePos.y = 1 - (e.clientY / window.innerHeight) * 2;
      stageElem.style.transform =
        "rotateX(" + mousePos.y * 5 + "deg) rotateY(" + mousePos.x * 5 + "deg)";
    });
  
    window.addEventListener("resize", resizeHandler);
  
    stageElem.addEventListener("click", function (e) {
      new Character({
        xPos: (e.clientX / window.innerWidth) * 100,
      });
    });
  
    resizeHandler();
  })();
  ```

+ js/Character.js

  ```js
  function Character(info) {
    this.mainElem = document.createElement("div");
    this.mainElem.classList.add("character");
    this.mainElem.innerHTML =
      "" +
      '<div class="character-face-con character-head">' +
      '<div class="character-face character-head-face face-front"></div>' +
      '<div class="character-face character-head-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-torso">' +
      '<div class="character-face character-torso-face face-front"></div>' +
      '<div class="character-face character-torso-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-right">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-left">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-right">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-left">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>";
  
    document.querySelector(".stage").appendChild(this.mainElem);
  
    this.mainElem.style.left = info.xPos + "%";
  }
  ```

## 스크롤 시 캐릭터 팔/다리 움직이기

+ css/style.css

  ```css
  @keyframes ani-head {
    to {
      transform: rotateX(-10deg);
    }
  }
  
  @keyframes ani-running-leg {
    from {
      transform: rotateX(-30deg);
    }
    to {
      transform: rotateX(30deg);
    }
  }
  
  @keyframes ani-running-arm {
    from {
      transform: rotateY(-30deg);
    }
    to {
      transform: rotateY(30deg);
    }
  }
  
  body {
    height: 500vw;
    font-family: "Apple SD Gothic Neo", "Roboto", "Noto Sans KR", NanumGothic,
      "Malgun Gothic", sans-serif;
    -webkit-overflow-scrolling: touch;
    color: #555;
    background: #fff000;
    transition: background 0.5s;
  }
  .world {
    position: fixed;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    perspective: 1000px;
  }
  .stage {
    position: absolute;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    transform-style: preserve-3d;
  }
  .house {
    width: 100vw;
    height: 100vh;
    transform: translateZ(-490vw);
    transform-style: preserve-3d;
  }
  .wall {
    position: absolute;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.8);
  }
  .wall-left {
    width: 1000vw;
    background: #f8f8f8;
    transform: rotateY(90deg) translateZ(-500vw);
  }
  .wall-right {
    width: 1000vw;
    background: #f8f8f8;
    transform: rotateY(90deg) translateZ(-400vw);
  }
  .wall-front-a {
    transform: translateZ(300vw);
  }
  .wall-front-b {
    transform: translateZ(50vw);
  }
  .wall-front-c {
    transform: translateZ(-200vw);
  }
  .wall-front-d {
    transform: translateZ(-500vw);
  }
  .wall-content {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }
  .wall-title {
    font-size: 5rem;
  }
  .progress-bar-con {
    position: fixed;
    left: 0;
    top: 0;
    z-index: 100;
    width: 100vw;
    height: 5px;
    background: #555;
  }
  .progress-bar {
    width: 0;
    height: 100%;
    background: #00a8ff;
  }
  
  /* character */
  .character {
    position: absolute;
    left: 12%;
    bottom: 5%;
    width: 10vw;
    height: 15.58vw;
    transform-style: preserve-3d;
  }
  .character[data-direction="forward"] {
    transform: rotateY(180deg);
  }
  .character[data-direction="backword"] {
    transform: rotateY(0deg);
  }
  .character[data-direction="left"] {
    transform: rotateY(-90deg);
  }
  .character[data-direction="right"] {
    transform: rotateY(90deg);
  }
  .character-face-con {
    position: absolute;
    transform-style: preserve-3d;
    transition: 1s;
  }
  .character-face {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-repeat: no-repeat;
    background-position: 0 0;
    background-size: cover;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }
  .character-face.face-back {
    transform: rotateY(180deg);
  }
  .character-head {
    left: calc(42 / 856 * 100%);
    top: 0;
    z-index: 60;
    width: calc(770 / 856 * 100%);
    height: calc(648 / 1334 * 100%);
    transform-origin: center bottom;
    animation: ani-head 0.6s infinite alternate
      cubic-bezier(0.46, 0.18, 0.66, 0.93);
  }
  .character-head-face.face-front {
    background-image: url("../images/ilbuni_head_front.png");
  }
  .character-head-face.face-back {
    background-image: url("../images/ilbuni_head_back.png");
  }
  .character-torso {
    left: calc(208 / 856 * 100%);
    top: calc(647 / 1334 * 100%);
    z-index: 50;
    width: calc(428 / 856 * 100%);
    height: calc(385 / 1334 * 100%);
    transform-origin: center center;
  }
  .character-torso-face.face-front {
    background-image: url("../images/ilbuni_body_front.png");
  }
  .character-torso-face.face-back {
    background-image: url("../images/ilbuni_body_back.png");
  }
  .character-arm-right {
    left: 0;
    top: calc(648 / 1334 * 100%);
    width: calc(244 / 856 * 100%);
    height: calc(307 / 1334 * 100%);
    transform-origin: right top;
  }
  .character-arm-right .face-front {
    background-image: url("../images/ilbuni_arm_0.png");
  }
  .character-arm-right .face-back {
    background-image: url("../images/ilbuni_arm_1.png");
  }
  .character-arm-left {
    left: calc(600 / 856 * 100%);
    top: calc(648 / 1334 * 100%);
    width: calc(244 / 856 * 100%);
    height: calc(307 / 1334 * 100%);
    transform-origin: left top;
  }
  .character-arm-left .face-front {
    background-image: url("../images/ilbuni_arm_1.png");
  }
  .character-arm-left .face-back {
    background-image: url("../images/ilbuni_arm_0.png");
  }
  .character-leg-right {
    left: calc(200 / 856 * 100%);
    top: calc(1031 / 1334 * 100%);
    width: calc(230 / 856 * 100%);
    height: calc(300 / 1334 * 100%);
    transform-origin: center top;
  }
  .character-leg-right .face-front {
    background-image: url("../images/ilbuni_leg_0.png");
  }
  .character-leg-right .face-back {
    background-image: url("../images/ilbuni_leg_1.png");
  }
  .character-leg-left {
    left: calc(414 / 856 * 100%);
    top: calc(1031 / 1334 * 100%);
    width: calc(230 / 856 * 100%);
    height: calc(300 / 1334 * 100%);
    transform-origin: center top;
  }
  .character-leg-left .face-front {
    background-image: url("../images/ilbuni_leg_1.png");
  }
  .character-leg-left .face-back {
    background-image: url("../images/ilbuni_leg_0.png");
  }
  .character.running .character-leg-right {
    animation: ani-running-leg 0.2s alternate infinite linear;
  }
  .character.running .character-leg-left {
    animation: ani-running-leg 0.2s alternate-reverse infinite linear;
  }
  .character.running .character-arm {
    animation: ani-running-arm 0.2s alternate infinite linear;
  }
  
  body[data-char="ragirl"] .character {
    width: 12vw;
    height: calc(12vw * 1.4135);
  }
  body[data-char="ragirl"] .character-head {
    left: calc(23 / 948 * 100%);
    width: calc(920 / 948 * 100%);
    height: calc(750 / 1340 * 100%);
  }
  body[data-char="ragirl"] .character-head-face.face-front {
    background-image: url("../images/ragirl_head_front.png");
  }
  body[data-char="ragirl"] .character-head-face.face-back {
    background-image: url("../images/ragirl_head_back.png");
  }
  body[data-char="ragirl"] .character-torso {
    left: calc(273 / 948 * 100%);
    top: calc(630 / 1340 * 100%);
    z-index: 50;
    width: calc(402 / 948 * 100%);
    height: calc(444 / 1340 * 100%);
    transform-origin: center center;
  }
  body[data-char="ragirl"] .character-torso-face.face-front {
    background-image: url("../images/ragirl_body_front.png");
  }
  body[data-char="ragirl"] .character-torso-face.face-back {
    background-image: url("../images/ragirl_body_back.png");
  }
  body[data-char="ragirl"] .character-arm-right {
    left: calc(134 / 948 * 100%);
    top: calc(709 / 1340 * 100%);
    width: calc(138 / 948 * 100%);
    height: calc(300 / 1340 * 100%);
    transform-origin: right top;
  }
  body[data-char="ragirl"] .character-arm-right .face-front {
    background-image: url("../images/ragirl_arm_0_front.png");
  }
  body[data-char="ragirl"] .character-arm-right .face-back {
    background-image: url("../images/ragirl_arm_1_back.png");
  }
  body[data-char="ragirl"] .character-arm-left {
    left: calc(675 / 948 * 100%);
    top: calc(709 / 1340 * 100%);
    width: calc(138 / 948 * 100%);
    height: calc(300 / 1340 * 100%);
    transform-origin: left top;
  }
  body[data-char="ragirl"] .character-arm-left .face-front {
    background-image: url("../images/ragirl_arm_1_front.png");
  }
  body[data-char="ragirl"] .character-arm-left .face-back {
    background-image: url("../images/ragirl_arm_0_back.png");
  }
  body[data-char="ragirl"] .character-leg-right {
    left: calc(290 / 948 * 100%);
    top: calc(1075 / 1340 * 100%);
    width: calc(186 / 948 * 100%);
    height: calc(264 / 1340 * 100%);
    transform-origin: center top;
  }
  body[data-char="ragirl"] .character-leg-right .face-front {
    background-image: url("../images/ragirl_leg_0.png");
  }
  body[data-char="ragirl"] .character-leg-right .face-back {
    background-image: url("../images/ragirl_leg_1.png");
  }
  body[data-char="ragirl"] .character-leg-left {
    left: calc(474 / 948 * 100%);
    top: calc(1075 / 1340 * 100%);
    width: calc(186 / 948 * 100%);
    height: calc(264 / 1340 * 100%);
    transform-origin: center top;
  }
  body[data-char="ragirl"] .character-leg-left .face-front {
    background-image: url("../images/ragirl_leg_1.png");
  }
  body[data-char="ragirl"] .character-leg-left .face-back {
    background-image: url("../images/ragirl_leg_0.png");
  }
  ```

+ js/Character.js

  ```js
  function Character(info) {
    this.mainElem = document.createElement("div");
    this.mainElem.classList.add("character");
    this.mainElem.innerHTML =
      "" +
      '<div class="character-face-con character-head">' +
      '<div class="character-face character-head-face face-front"></div>' +
      '<div class="character-face character-head-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-torso">' +
      '<div class="character-face character-torso-face face-front"></div>' +
      '<div class="character-face character-torso-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-right">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-left">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-right">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-left">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>";
  
    document.querySelector(".stage").appendChild(this.mainElem);
  
    this.mainElem.style.left = info.xPos + "%";
    this.init();
  }
  
  Character.prototype = {
    constructor: Character,
    init: function () {
      const self = this;
  
      window.addEventListener("scroll", function () {
        self.mainElem.classList.add("running");
      });
    },
  };
  ```

## 스크롤 멈추면 팔/다리 멈추기

+ js/Character.js

  ```js
  function Character(info) {
    this.mainElem = document.createElement("div");
    this.mainElem.classList.add("character");
    this.mainElem.innerHTML =
      "" +
      '<div class="character-face-con character-head">' +
      '<div class="character-face character-head-face face-front"></div>' +
      '<div class="character-face character-head-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-torso">' +
      '<div class="character-face character-torso-face face-front"></div>' +
      '<div class="character-face character-torso-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-right">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-left">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-right">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-left">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>";
  
    document.querySelector(".stage").appendChild(this.mainElem);
  
    this.mainElem.style.left = info.xPos + "%";
    // 스크롤 중인지 아닌지
    this.scrollState = false;
    this.init();
  }
  
  Character.prototype = {
    constructor: Character,
    init: function () {
      const self = this;
  
      window.addEventListener("scroll", function () {
        clearTimeout(self.scrollState);
  
        if (!self.scrollState) {
          self.mainElem.classList.add("running");
          console.log("running 클래스 붙음");
        }
  
        self.scrollState = setTimeout(function () {
          self.scrollState = false;
          self.mainElem.classList.remove("running");
        }, 500);
        console.log(self.scrollState);
      });
    },
  };
  ```

## 스크롤 방향(위/아래) 감지

+ js/Character.js

  ```js
  function Character(info) {
    this.mainElem = document.createElement("div");
    this.mainElem.classList.add("character");
    this.mainElem.innerHTML =
      "" +
      '<div class="character-face-con character-head">' +
      '<div class="character-face character-head-face face-front"></div>' +
      '<div class="character-face character-head-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-torso">' +
      '<div class="character-face character-torso-face face-front"></div>' +
      '<div class="character-face character-torso-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-right">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-left">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-right">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-left">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>";
  
    document.querySelector(".stage").appendChild(this.mainElem);
  
    this.mainElem.style.left = info.xPos + "%";
    // 스크롤 중인지 아닌지
    this.scrollState = false;
    // 바로 이전(마지막) 스크롤 위치
    this.lastScrollTop = 0;
    this.init();
  }
  
  Character.prototype = {
    constructor: Character,
    init: function () {
      const self = this;
  
      window.addEventListener("scroll", function () {
        clearTimeout(self.scrollState);
  
        if (!self.scrollState) {
          self.mainElem.classList.add("running");
          console.log("running 클래스 붙음");
        }
  
        self.scrollState = setTimeout(function () {
          self.scrollState = false;
          self.mainElem.classList.remove("running");
        }, 500);
  
        // 이전 스크롤 위치와 현재 스크롤 위치 비교
        if (self.lastScrollTop > pageYOffset) {
          // 이전 스크롤 위치가 크다면: 스크롤 올림
          self.mainElem.setAttribute("data-direction", "backward");
        } else {
          // 현재 스크롤 위치가 크다면: 스크롤 내림
          self.mainElem.setAttribute("data-direction", "forward");
        }
  
        self.lastScrollTop = pageYOffset;
      });
    },
  };
  ```

## 캐릭터 좌/우 이동

+ keyCode 참고: [http://keycode.info/](http://keycode.info/)

+ js/Character.js

  ```js
  function Character(info) {
    this.mainElem = document.createElement("div");
    this.mainElem.classList.add("character");
    this.mainElem.innerHTML =
      "" +
      '<div class="character-face-con character-head">' +
      '<div class="character-face character-head-face face-front"></div>' +
      '<div class="character-face character-head-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-torso">' +
      '<div class="character-face character-torso-face face-front"></div>' +
      '<div class="character-face character-torso-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-right">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-left">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-right">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-left">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>";
  
    document.querySelector(".stage").appendChild(this.mainElem);
  
    this.mainElem.style.left = info.xPos + "%";
    // 스크롤 중인지 아닌지
    this.scrollState = false;
    // 바로 이전(마지막) 스크롤 위치
    this.lastScrollTop = 0;
    this.xPos = info.xPos;
    this.speed = 0.3;
    this.direction;
    // 좌우 이동 중인지 아닌지
    this.runningState = false;
    this.rafId;
    this.init();
  }
  
  Character.prototype = {
    constructor: Character,
    init: function () {
      const self = this;
  
      window.addEventListener("scroll", function () {
        clearTimeout(self.scrollState);
  
        if (!self.scrollState) {
          self.mainElem.classList.add("running");
          console.log("running 클래스 붙음");
        }
  
        self.scrollState = setTimeout(function () {
          self.scrollState = false;
          self.mainElem.classList.remove("running");
        }, 500);
  
        // 이전 스크롤 위치와 현재 스크롤 위치 비교
        if (self.lastScrollTop > pageYOffset) {
          // 이전 스크롤 위치가 크다면: 스크롤 올림
          self.mainElem.setAttribute("data-direction", "backward");
        } else {
          // 현재 스크롤 위치가 크다면: 스크롤 내림
          self.mainElem.setAttribute("data-direction", "forward");
        }
  
        self.lastScrollTop = pageYOffset;
      });
  
      window.addEventListener("keydown", function (e) {
        if (self.runningState) return;
  
        if (e.keyCode == 37) {
          // 왼쪽
          self.direction = "left";
          self.mainElem.setAttribute("data-direction", "left");
          self.mainElem.classList.add("running");
          self.run(self);
          self.runningState = true;
        } else if (e.keyCode == 39) {
          // 오른쪽
          self.direction = "right";
          self.mainElem.setAttribute("data-direction", "right");
          self.mainElem.classList.add("running");
          self.run(self);
          self.runningState = true;
        }
      });
  
      window.addEventListener("keyup", function (e) {
        self.mainElem.classList.remove("running");
        cancelAnimationFrame(self.rafId);
        self.runningState = false;
      });
    },
    run: function (self) {
      if (self.direction == "left") {
        self.xPos -= self.speed;
      } else if (self.direction == "right") {
        self.xPos += self.speed;
      }
  
      self.mainElem.style.left = self.xPos + "%";
  
      self.rafId = requestAnimationFrame(function () {
        self.run(self);
      });
    },
  };
  ```

## 좌/우 이동 공간 제한

+ js/Character.js

  ```js
  function Character(info) {
    this.mainElem = document.createElement("div");
    this.mainElem.classList.add("character");
    this.mainElem.innerHTML =
      "" +
      '<div class="character-face-con character-head">' +
      '<div class="character-face character-head-face face-front"></div>' +
      '<div class="character-face character-head-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-torso">' +
      '<div class="character-face character-torso-face face-front"></div>' +
      '<div class="character-face character-torso-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-right">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-left">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-right">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-left">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>";
  
    document.querySelector(".stage").appendChild(this.mainElem);
  
    this.mainElem.style.left = info.xPos + "%";
    // 스크롤 중인지 아닌지
    this.scrollState = false;
    // 바로 이전(마지막) 스크롤 위치
    this.lastScrollTop = 0;
    this.xPos = info.xPos;
    this.speed = 0.3;
    this.direction;
    // 좌우 이동 중인지 아닌지
    this.runningState = false;
    this.rafId;
    this.init();
  }
  
  Character.prototype = {
    constructor: Character,
    init: function () {
      const self = this;
  
      window.addEventListener("scroll", function () {
        clearTimeout(self.scrollState);
  
        if (!self.scrollState) {
          self.mainElem.classList.add("running");
          console.log("running 클래스 붙음");
        }
  
        self.scrollState = setTimeout(function () {
          self.scrollState = false;
          self.mainElem.classList.remove("running");
        }, 500);
  
        // 이전 스크롤 위치와 현재 스크롤 위치 비교
        if (self.lastScrollTop > pageYOffset) {
          // 이전 스크롤 위치가 크다면: 스크롤 올림
          self.mainElem.setAttribute("data-direction", "backward");
        } else {
          // 현재 스크롤 위치가 크다면: 스크롤 내림
          self.mainElem.setAttribute("data-direction", "forward");
        }
  
        self.lastScrollTop = pageYOffset;
      });
  
      window.addEventListener("keydown", function (e) {
        if (self.runningState) return;
  
        if (e.keyCode == 37) {
          // 왼쪽
          self.direction = "left";
          self.mainElem.setAttribute("data-direction", "left");
          self.mainElem.classList.add("running");
          self.run(self);
          self.runningState = true;
        } else if (e.keyCode == 39) {
          // 오른쪽
          self.direction = "right";
          self.mainElem.setAttribute("data-direction", "right");
          self.mainElem.classList.add("running");
          self.run(self);
          self.runningState = true;
        }
      });
  
      window.addEventListener("keyup", function (e) {
        self.mainElem.classList.remove("running");
        cancelAnimationFrame(self.rafId);
        self.runningState = false;
      });
    },
    run: function (self) {
      if (self.direction == "left") {
        self.xPos -= self.speed;
      } else if (self.direction == "right") {
        self.xPos += self.speed;
      }
  
      if (self.xPos < 2) {
        self.xPos = 2;
      }
      if (self.xPos > 88) {
        self.xPos = 88;
      }
  
      self.mainElem.style.left = self.xPos + "%";
  
      self.rafId = requestAnimationFrame(function () {
        self.run(self);
      });
    },
  };
  ```

## 캐릭터 속도 차이(랜덤)

+ js/wall3d.js

  ```js
  (function () {
    const stageElem = document.querySelector(".stage");
    const houseElem = document.querySelector(".house");
    const barElem = document.querySelector(".progress-bar");
    const mousePos = { x: 0, y: 0 };
    let maxScrollValue;
  
    function resizeHandler() {
      maxScrollValue = document.body.offsetHeight - window.innerHeight;
    }
  
    window.addEventListener("scroll", function () {
      const scrollPer = pageYOffset / maxScrollValue;
      const zMove = scrollPer * 980 - 490;
      houseElem.style.transform = "translateZ(" + zMove + "vw)";
  
      // progress bar
      barElem.style.width = scrollPer * 100 + "%";
    });
  
    window.addEventListener("mousemove", function (e) {
      mousePos.x = -1 + (e.clientX / window.innerWidth) * 2;
      mousePos.y = 1 - (e.clientY / window.innerHeight) * 2;
      stageElem.style.transform =
        "rotateX(" + mousePos.y * 5 + "deg) rotateY(" + mousePos.x * 5 + "deg)";
    });
  
    window.addEventListener("resize", resizeHandler);
  
    stageElem.addEventListener("click", function (e) {
      new Character({
        xPos: (e.clientX / window.innerWidth) * 100,
        speed: Math.random() * 0.5 + 0.2,
      });
    });
  
    resizeHandler();
  })();
  ```

+ js/Character.js

  ```js
  function Character(info) {
    this.mainElem = document.createElement("div");
    this.mainElem.classList.add("character");
    this.mainElem.innerHTML =
      "" +
      '<div class="character-face-con character-head">' +
      '<div class="character-face character-head-face face-front"></div>' +
      '<div class="character-face character-head-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-torso">' +
      '<div class="character-face character-torso-face face-front"></div>' +
      '<div class="character-face character-torso-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-right">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-arm character-arm-left">' +
      '<div class="character-face character-arm-face face-front"></div>' +
      '<div class="character-face character-arm-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-right">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>" +
      '<div class="character-face-con character-leg character-leg-left">' +
      '<div class="character-face character-leg-face face-front"></div>' +
      '<div class="character-face character-leg-face face-back"></div>' +
      "</div>";
  
    document.querySelector(".stage").appendChild(this.mainElem);
  
    this.mainElem.style.left = info.xPos + "%";
    // 스크롤 중인지 아닌지
    this.scrollState = false;
    // 바로 이전(마지막) 스크롤 위치
    this.lastScrollTop = 0;
    this.xPos = info.xPos;
    this.speed = info.speed;
    this.direction;
    // 좌우 이동 중인지 아닌지
    this.runningState = false;
    this.rafId;
    this.init();
  }
  
  Character.prototype = {
    constructor: Character,
    init: function () {
      const self = this;
  
      window.addEventListener("scroll", function () {
        clearTimeout(self.scrollState);
  
        if (!self.scrollState) {
          self.mainElem.classList.add("running");
          console.log("running 클래스 붙음");
        }
  
        self.scrollState = setTimeout(function () {
          self.scrollState = false;
          self.mainElem.classList.remove("running");
        }, 500);
  
        // 이전 스크롤 위치와 현재 스크롤 위치 비교
        if (self.lastScrollTop > pageYOffset) {
          // 이전 스크롤 위치가 크다면: 스크롤 올림
          self.mainElem.setAttribute("data-direction", "backward");
        } else {
          // 현재 스크롤 위치가 크다면: 스크롤 내림
          self.mainElem.setAttribute("data-direction", "forward");
        }
  
        self.lastScrollTop = pageYOffset;
      });
  
      window.addEventListener("keydown", function (e) {
        if (self.runningState) return;
  
        if (e.keyCode == 37) {
          // 왼쪽
          self.direction = "left";
          self.mainElem.setAttribute("data-direction", "left");
          self.mainElem.classList.add("running");
          self.run(self);
          self.runningState = true;
        } else if (e.keyCode == 39) {
          // 오른쪽
          self.direction = "right";
          self.mainElem.setAttribute("data-direction", "right");
          self.mainElem.classList.add("running");
          self.run(self);
          self.runningState = true;
        }
      });
  
      window.addEventListener("keyup", function (e) {
        self.mainElem.classList.remove("running");
        cancelAnimationFrame(self.rafId);
        self.runningState = false;
      });
    },
    run: function (self) {
      if (self.direction == "left") {
        self.xPos -= self.speed;
      } else if (self.direction == "right") {
        self.xPos += self.speed;
      }
  
      if (self.xPos < 2) {
        self.xPos = 2;
      }
      if (self.xPos > 88) {
        self.xPos = 88;
      }
  
      self.mainElem.style.left = self.xPos + "%";
  
      self.rafId = requestAnimationFrame(function () {
        self.run(self);
      });
    },
  };
  ```

## 테마/캐릭터 변경

+ css/style.css

  ```css
  /* character button */
  .select-character {
    display: flex;
    align-items: center;
    position: fixed;
    right: 10px;
    top: 10px;
    z-index: 100;
  }
  .select-character-btn {
    width: 40px;
    height: 40px;
    margin-left: 5px;
    border: 0;
    background-color: transparent;
    background-repeat: no-repeat;
    background-position: 50% 50%;
    background-size: contain;
    cursor: pointer;
    transition: 0.5s;
  }
  .select-character-btn-ilbuni {
    background-image: url("../images/ilbuni_head_front.png");
    background-size: 36px auto;
  }
  .select-character-btn-ragirl {
    background-image: url("../images/ragirl_head_front.png");
    opacity: 0.5;
  }
  body[data-char="ragirl"] .select-character-btn-ilbuni {
    opacity: 0.5;
  }
  body[data-char="ilbuni"] .select-character-btn-ilbuni,
  body[data-char="ragirl"] .select-character-btn-ragirl {
    opacity: 1;
  }
  ```

+ js/wall3d.js

  ```js
  (function () {
    const stageElem = document.querySelector(".stage");
    const houseElem = document.querySelector(".house");
    const barElem = document.querySelector(".progress-bar");
    const selectCharacterElem = document.querySelector(".select-character");
    const mousePos = { x: 0, y: 0 };
    let maxScrollValue;
  
    function resizeHandler() {
      maxScrollValue = document.body.offsetHeight - window.innerHeight;
    }
  
    window.addEventListener("scroll", function () {
      const scrollPer = pageYOffset / maxScrollValue;
      const zMove = scrollPer * 980 - 490;
      houseElem.style.transform = "translateZ(" + zMove + "vw)";
  
      // progress bar
      barElem.style.width = scrollPer * 100 + "%";
    });
  
    window.addEventListener("mousemove", function (e) {
      mousePos.x = -1 + (e.clientX / window.innerWidth) * 2;
      mousePos.y = 1 - (e.clientY / window.innerHeight) * 2;
      stageElem.style.transform =
        "rotateX(" + mousePos.y * 5 + "deg) rotateY(" + mousePos.x * 5 + "deg)";
    });
  
    window.addEventListener("resize", resizeHandler);
  
    stageElem.addEventListener("click", function (e) {
      new Character({
        xPos: (e.clientX / window.innerWidth) * 100,
        speed: Math.random() * 0.5 + 0.2,
      });
    });
  
    selectCharacterElem.addEventListener("click", function (e) {
      const value = e.target.getAttribute("data-char");
      document.body.setAttribute("data-char", value);
    });
  
    resizeHandler();
  })();
  ```

  